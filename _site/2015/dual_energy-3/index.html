<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Evan's research blog - Dual Energy Tests (Part 3)</title>
  <link rel="shortcut icon" href="http://evaneschneider.github.io/site/assets/images/favicon.ico">
  <link rel="stylesheet" href="http://evaneschneider.github.io/site/assets/css/style.css">
  <link rel="alternate" type="application/rss+xml" title="My Blog" href="http://evaneschneider.github.io/site/rss.xml">
  <link rel="stylesheet" href="http://evaneschneider.github.io/site/assets/css/highlight.css">
</head>
<body>

  <nav class="main-nav">
    
        <a href="http://evaneschneider.github.io/site/"> <span class="arrow">←</span> Home </a>
    

    
        
            <a href="http://evaneschneider.github.io/site/about">About </a>
        
    
    <a class="cta" href="http://evaneschneider.github.io/site/feed.xml">Subscribe</a>
</nav>

  

  <section id="wrapper" class="">
    <article class="post">
    <header>
        <h1>Dual Energy Tests (Part 3)</h1>
        <h2 class="headline">October 1, 2015</h2>
    </header>
    <section id="post-body">
        <p>In an effort to discover why the dual energy formalism is producing such unsatisfactory 
results on the high mach number shock tube, now I will look at a simpler test. In this 
post, I test an advected square wave (a density enhancement in pressure equilibrium 
moving across a periodic grid).</p>

<p><strong>The tests</strong></p>

<p>In the following tests, the pressure is <script type="math/tex">p = 0.01</script> everywhere,
<script type="math/tex">\gamma = \frac{5}{3}</script>, and density is <script type="math/tex">\rho = 1.0 * A</script>, where 
<script type="math/tex">A = 1.5</script> in the middle section of the grid, and <script type="math/tex">A = 1.0</script> elsewhere.
<script type="math/tex">c_s = \sqrt{\frac{\gamma * p}{\rho}}</script> ranges from 0.105 in the high density
regions to 0.129 in the high density regions.</p>

<p>The domain goes from <script type="math/tex">x = [0, 1]</script>. For the low mach number test, <script type="math/tex">v = 1.0</script>,
so the mach number is <script type="math/tex">M \approx 8</script>. For the high mach number test, <script type="math/tex">v = 100</script>,
so the mach number is <script type="math/tex">M \approx 800</script>. The tests are run until <script type="math/tex">t = 1.0</script>,
such that the low velocity test crosses the grid once, and the high velocity test
crosses the grid 100 times.</p>

<p><strong>Without Dual Energy</strong></p>

<p>Figure 1: PPMP, exact solver, no dual energy, <script type="math/tex">v \approx 8 c_s</script>
<img src="http://localhost:4000assets/images/PPMP_exact_M8_node.png" /></p>

<p>Figure 2: Same as Figure 1 but with <script type="math/tex">v \approx 800 c_s</script>
<img src="http://localhost:4000assets/images/PPMP_exact_M800_node.png" /></p>

<p>PPMP fares quite well on this test, even at high mach number (not surprising,
given that’s what it was designed to do). But what happens if we turn on the
Enzo dual energy switch?</p>

<p><strong>With Dual Energy</strong></p>

<p>At low mach number, the switch doesn’t activate dual energy, and the results 
are identical to Figure 1. At high mach number <script type="math/tex">(v = 100 \approx 800 c_s)</script>, the 
switch kicks in, and the results are a mess.</p>

<p>Figure 3: Same as Figure 2 but with dual energy
<img src="http://localhost:4000assets/images/PPMP_exact_M800_de.png" /></p>

<p>Figure 4: Same as Figure 4 but with PPMC 
<img src="http://localhost:4000assets/images/PPMC_exact_M800_de.png" /></p>

<p><strong>The Internal Energy Update</strong></p>

<p>The equation that is used to update the internal energy has two parts: a term that 
represents the advected flux of internal energy, and a term that represents the gain 
or loss of internal energy due to pressure and velocity gradients. In this case, the velocity
is equal across all cells, so the second term should be 0. For the first time step, this criterion 
holds, but by the second, there are already a few cells which show a very small velocity gradient.</p>

<p>Is this because the first term isn’t acting properly? Or because it’s simply not accurate enough?</p>

    </section>
</article>
<footer id="post-meta" class="clearfix">
    <a href="http://twitter.com/navelation">
        <img class="avatar" src="http://evaneschneider.github.io/site/assets/images/avatar.png">
        <div>
            <span class="dark">Evan Schneider</span>
            <span>Blogging about stuff</span>
        </div>
    </a>

    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=/2015/dual_energy-3/ - Dual Energy Tests (Part 3) by @navelation"><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>
    </section>
</footer>

<!-- Disqus comments -->


<!-- Archive post list -->




  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="http://evaneschneider.github.io/site/assets/js/main.js"></script>
  <script src="http://evaneschneider.github.io/site/assets/js/highlight.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXXX-X', 'auto');
    ga('send', 'pageview');
  </script>
  <!-- Include mathjax support -->
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

</body>
</html>



