<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title> - Dual Energy Tests (Part 4)</title>
  <link rel="shortcut icon" href="http://evaneschneider.github.io/site/assets/images/favicon.ico">
  <link rel="stylesheet" href="http://evaneschneider.github.io/site/assets/css/style.css">
  <link rel="alternate" type="application/rss+xml" title="My Blog" href="http://evaneschneider.github.io/site/rss.xml">
  <link rel="stylesheet" href="http://evaneschneider.github.io/site/assets/css/highlight.css">
</head>
<body>

  <nav class="main-nav">
    
        <a href="http://evaneschneider.github.io/site/"> <span class="arrow">←</span> Home </a>
    

    
        
            <a href="http://evaneschneider.github.io/site/about">About </a>
        
    
    <a class="cta" href="http://evaneschneider.github.io/site/feed.xml">Subscribe</a>
</nav>

  

  <section id="wrapper" class="">
    <article class="post">
    <header>
        <h1>Dual Energy Tests (Part 4)</h1>
        <h2 class="headline">October 2, 2015</h2>
    </header>
    <section id="post-body">
        <p>Here, I continue to use the high mach number square wave test from the 
previous post to try to figure out why the internal energy update is going 
wrong. At the end of the last post, I mentioned that the $Pdv$ term should always 
be 0 for the square wave test, because the velocity
should remain constant across cells. By the second timestep, this condition is
already violated. So, what happened in the first timestep to cause a velocity gradient?</p>

<p>As before, I use the Teyssier equation to update the internal energy:</p>

\[\frac{e^{n+1}_\mathrm{prim} - e^n}{\Delta t} = - \nabla \cdot \mathbf{F}(e)^n - P^n \nabla \cdot \mathbf{u}^n\]

<p>Note: \(e\) in this equation is actually \(\rho e_{int}\) in cholla notation. In practice, this equation
is represented in cholla as</p>

\[\rho^{n+1} e^{n+1} = \rho^n e^n + \frac{\Delta t}{\Delta x}(\bar{\rho}_{i-\frac{1}{2}}\bar{v}_{i-\frac{1}{2}}\bar{e}_{i-\frac{1}{2}} - \bar{\rho}_{i+\frac{1}{2}}\bar{v}_{i+\frac{1}{2}}\bar{e}_{i+\frac{1}{2}}) + \frac{\Delta t}{2 \Delta x} P^n (v^n_{i-1} - v^n_{i+1})\]

<p>Here, bars over a variable indicate that it is the sampled value from the Riemann solver. For \(\bar{e}\) 
this just means an advected term. Because the flux term is density weighted, and the sampled velocities are equal,
<em>the flux terms should be identical</em>, and \(\rho e\) should
remain constant across all cells.</p>

<p>This seems to be where the method is failing. In the first time step, the net flux is 0
across all cells <em>except the two at the density contacts.</em> Because the internal energy update 
is preferred over the total energy update using the Bryan switch, the total energy at the 
end of the first timestep reflects the slight perturbation. This gets translated to a slight 
perturbation in the pressure for the next timestep (since all the velocities remained equal at the 
end of the first timestep), and things spiral out of control from there.</p>

<p>So, is there a way to prevent the perturbation in \(\rho e_{int}\), or is it endemic to the method, 
and a better solution is to prevent the switch from activating in this scenario? The Teyssier switch, 
for example, would never activate in the square wave test, no matter how fast the mach number.</p>

<p>Note: the same problem occurs using PPMC, so it’s not an issue with contact steepening.</p>


    </section>
</article>
<footer id="post-meta" class="clearfix">
    <a href="http://twitter.com/navelation">
        <img class="avatar" src="http://evaneschneider.github.io/site/assets/images/avatar.png">
        <div>
            <span class="dark">Evan Schneider</span>
            <span>Blogging about stuff</span>
        </div>
    </a>

    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=/2015/dual_energy-4/ - Dual Energy Tests (Part 4) by @navelation"><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>
    </section>
</footer>

<!-- Disqus comments -->


<!-- Archive post list -->




  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="http://evaneschneider.github.io/site/assets/js/main.js"></script>
  <script src="http://evaneschneider.github.io/site/assets/js/highlight.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXXX-X', 'auto');
    ga('send', 'pageview');
  </script>
  <!-- Include mathjax support -->
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

</body>
</html>



