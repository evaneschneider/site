<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title> - Thermal Instability</title>
  <link rel="shortcut icon" href="http://evaneschneider.github.io/site/assets/images/favicon.ico">
  <link rel="stylesheet" href="http://evaneschneider.github.io/site/assets/css/style.css">
  <link rel="alternate" type="application/rss+xml" title="My Blog" href="http://evaneschneider.github.io/site/rss.xml">
  <link rel="stylesheet" href="http://evaneschneider.github.io/site/assets/css/highlight.css">
</head>
<body>

  <nav class="main-nav">
    
        <a href="http://evaneschneider.github.io/site/"> <span class="arrow">←</span> Home </a>
    

    
        
            <a href="http://evaneschneider.github.io/site/about">About </a>
        
    
    <a class="cta" href="http://evaneschneider.github.io/site/feed.xml">Subscribe</a>
</nav>

  

  <section id="wrapper" class="">
    <article class="post">
    <header>
        <h1>Thermal Instability</h1>
        <h2 class="headline">February 9, 2018</h2>
    </header>
    <section id="post-body">
        <p>In this post, I’ll describe how I’ve set up two-phase ISM initial conditions for a future superbubble test. At present, the method mostly follows the description given in Kim &amp; Ostriker (2015).</p>

<p>Thermal instability is generated in a perturbed medium when the denser regions cool faster than less dense regions. The resulting pressure difference further compresses the denser patches, which further increases the cooling rate, because cooling is proportional to the density squared. If photoelectric heating of the gas is also applied, there will be two equilibrium solutions, one in a high density cold state, and one in a low density hot state.</p>

<p>To create thermal instability with Cholla, I first defined a new cooling function, \(\Lambda\), and a heating rate, \(\Gamma\). The net cooling rate per unit volume, is then given by</p>

<p>\(\rho L = n [n \Lambda(T) - \Gamma]\),</p>

<p>where \(n = \rho / (\mu m_\mathrm{H})\) is the number density calculated assuming \(\mu = 1.3\), as appropriate for solar metallicty neutral gas. For cooling and heating at temperatures below \(T = 10^4\) K, I use the analytic function given in Koyama &amp; Inutsuka (2002), which includes the effects of photoelectric heating, heating an ionization by cosmic rays and X-rays, heating by \(H_2\) formation and destruction, atomic line cooling, rovibrational line cooling, and atomic and molecular collisions with grains,</p>

<p>\(\Lambda(T) = \Gamma\, 10^7 \mathrm{exp}\left(\frac{-114800}{T + 1000}\right) + 0.014 \sqrt{T} \mathrm{exp}\left(\frac{-92}{T}\right)\,\mathrm{cm}^{3}\),</p>

<p>\(\Gamma = 2 \times 10^{-26}\,\mathrm{erg}\,\mathrm{s}^{-1}\).</p>

<p>(Note that in their paper, the coefficient on the second term is 14, but this seems to be a typo.) At temperatures above \(10^4\) K, I use a piecewise parabolic fit to a CIE cooling function calculated with Cloudy for solar metallicty gas, and neglect heating. That function is defined in the appendix of Schneider &amp; Robertson (2018). The combined cooling functions are plotted below:</p>

<p><img src="http://evaneschneider.github.io/site/assets/images/2018-March/cooling_curve.png" /></p>

<p>Below 10 K, I only include heating (this improves stability of the code while the thermal instability is developing). As in previous simulations, I limit the hydro timestep such that any given cell can lose a maximum of 10% of its thermal energy in a given timestep. I also use subcyling of the cooling timestep to ensure a robust solution to the explicit integration scheme. The cooling substep is limited such that the temperature changes by 1% (or less) in a single substep.</p>

<p>In order to generate thermal instabilty the initial conditions must contain density perturbations. Because I am not including thermal conduction in these calculations, there will be no converged solution for a given set of perturbations. To avoid creating arbitrarily small clouds, I only perturb on modes with wavelengths of \(0.25 L_\mathrm{box}\) or longer, where \(L_\mathrm{box}\) is the length of the box. The perturbations are given by</p>

<p>\(\frac{\delta \rho(x,y,z)}{\rho_0} = \frac{A}{i_\mathrm{max}j_\mathrm{max}k_\mathrm{max}} \sum_{i,j,k=0}^{i,j,k = \mathrm{max}} \mathrm{sin}[x k_i + y k_j + z k_k + \theta(k_i, k_j, k_k)]\),</p>

<p>where \(k_i = 2\pi i / L_\mathrm{box}\) is the wave number, \(A\) is the amplitude of the perturbations, and \(\theta\) is a random phase. As stated above, I use \(i_\mathrm{max} = j_\mathrm{max} = k_\mathrm{max} = 4\) for the simulations in this post. I set \(\rho_0\) such that the average number density \(n = 2\), and the initial pressure \(p / k_\mathrm{B} = 2348\,\mathrm{K}\,\mathrm{cm}^{-3}\). The amplitude of the initial perturbations is 10%. Below are movies showing the development of the instability in the density and temperature projections. The box size is \(L_\mathrm{box} = 100\) pc, and the resolution is \(256^3\).</p>

<div style="text-align: center">
<video src="http://evaneschneider.github.io/site/assets/movies/TI_density.mov" width="256" height="256" controls="" preload=""></video>
</div>

<div style="text-align: center">
<video src="http://evaneschneider.github.io/site/assets/movies/TI_temperature.mov" width="256" height="256" controls="" preload=""></video>
</div>

<p>The instability is saturated by \(\sim 75\,\mathrm{Myr}\), with the mean density in the low density regions of \(n\sim 0.27\,\mathrm{cm}^{-3}\) while in the high density clouds \(n\sim 27\,\mathrm{cm}^{-3}\). The corresponding temperatures in the low and high density regions are \(T\sim 80\) K and \(T\sim 6700\) K, respectively. Density and temperature slices through the central \(z\) and \(y\) planes are shown below.</p>

<p><img src="http://evaneschneider.github.io/site/assets/images/2018-March/dslice_TI_256.png" />
<img src="http://evaneschneider.github.io/site/assets/images/2018-March/Tslice_TI_256.png" /></p>

    </section>
</article>
<footer id="post-meta" class="clearfix">
    <a href="http://twitter.com/navelation">
        <img class="avatar" src="http://evaneschneider.github.io/site/assets/images/avatar.png">
        <div>
            <span class="dark">Evan Schneider</span>
            <span>Blogging about stuff</span>
        </div>
    </a>

    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=/2018/Thermal-Instability/ - Thermal Instability by @navelation"><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>
    </section>
</footer>

<!-- Disqus comments -->


<!-- Archive post list -->




  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="http://evaneschneider.github.io/site/assets/js/main.js"></script>
  <script src="http://evaneschneider.github.io/site/assets/js/highlight.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXXX-X', 'auto');
    ga('send', 'pageview');
  </script>
  <!-- Include mathjax support -->
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

</body>
</html>



