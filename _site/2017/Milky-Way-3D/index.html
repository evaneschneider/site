<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Evan's research blog - Milky Way 3D</title>
  <link rel="shortcut icon" href="http://evaneschneider.github.io/site/assets/images/favicon.ico">
  <link rel="stylesheet" href="http://evaneschneider.github.io/site/assets/css/style.css">
  <link rel="alternate" type="application/rss+xml" title="My Blog" href="http://evaneschneider.github.io/site/rss.xml">
  <link rel="stylesheet" href="http://evaneschneider.github.io/site/assets/css/highlight.css">
</head>
<body>

  <nav class="main-nav">
    
        <a href="http://evaneschneider.github.io/site/"> <span class="arrow">‚Üê</span> Home </a>
    

    
        
            <a href="http://evaneschneider.github.io/site/about">About </a>
        
    
    <a class="cta" href="http://evaneschneider.github.io/site/feed.xml">Subscribe</a>
</nav>

  

  <section id="wrapper" class="">
    <article class="post">
    <header>
        <h1>Milky Way 3D</h1>
        <h2 class="headline">February 22, 2017</h2>
    </header>
    <section id="post-body">
        <p>Once we add a third dimension, the initial conditions for an isothermal disk get a bit more complex.
In addition to balancing the radial components of the gravitational potential with circular velocity, 
I now need to balance the vertical acceleration via a pressure gradient, i.e. I need to make sure the 
disk is in hydrostatic balance. Given that the pressure and density can be related for an isothermal 
gas via the expression <script type="math/tex">P = \rho c_{s}^{2}</script>, this translates to calculating the vertical density profile 
at each radial location in the disk.</p>

<p><strong>The gravitational potential</strong></p>

<p>The static potential for the disk will once again be based on the Milky Way. Because it is spherically 
symmetric, the NFW halo can thus be expressed in exactly the same way as the 2D case, but for reasons that 
will become clear momentarily, I will express it in cylindrical coordinates, <script type="math/tex">(r, z)</script>:</p>

<script type="math/tex; mode=display">\Phi(r, z)_{h} = - \frac{G M_{halo}}{\sqrt{r^2 + z^2}f(c_{vir})}\mathrm{ln}(1+\frac{\sqrt{r^2 + z^2}}{r_h}).</script>

<p>Again, <script type="math/tex">f(y) = \mathrm{ln}(1+y) - \frac{y}{1+y}</script>, <script type="math/tex">x = \sqrt(r^2 + z^2) / r_{h}</script>, and  <script type="math/tex">r{_h}</script> is the halo scale 
length (see previous post for variable values).</p>

<p>The potential of the disk now has a vertical component, and becomes a Miyamoto-Nagai profile:</p>

<script type="math/tex; mode=display">\Phi(r, z)_{d} = - \frac{G M_{d}}{\sqrt{r^2 + (r_{d} + \sqrt{z^{2} + z_{d}^{2}})^2}},</script>

<p>where <script type="math/tex">r_{d} = 3.5</script> kpc is the disk scale length and <script type="math/tex">z_{d} = 0.2 r_{d}</script> is the disk scale height. From
these potentials, I can calculate the radial acceleration and associated circular velocity at every value 
of <script type="math/tex">z</script>, exactly as I did in the 2D case, as well as the vertical acceleration, <script type="math/tex">g_{z}</script>, at any 
point in <script type="math/tex">r</script>.</p>

<p><strong>Hydrostatic Equilibrium</strong></p>

<p>The potential described above gives the circular motion of the gas in the disk. For the 
disk surface density profile, I will again use an exponential in the radial direction:</p>

<script type="math/tex; mode=display">\Sigma(r) = \frac{M_{g}}{2\pi r_{g}^2} e^{-\frac{r}{r_{s}}},</script>

<p>where <script type="math/tex">r_{g}</script> is the gas disk scale length. I thus have the boundary conditions required in order to 
calculate the vertical density profile at each location in radius, as follows. I start with the equation 
for hydrostatic equilibrium in the vertical direction,</p>

<script type="math/tex; mode=display">\frac{\mathrm{d}P}{\mathrm{d}z} = -\rho g_{z},</script>

<p>where <script type="math/tex">g_{z}</script> is the vertical acceleration due to the combined halo+disk potential 
(<script type="math/tex">\frac{\mathrm{d}\Phi}{\mathrm{d}z}</script>). Given <script type="math/tex">P = \rho c_{s}^{2}</script>, I can solve 
for <script type="math/tex">\rho(z)</script>, the density profile as a function of <script type="math/tex">z</script>, at a given <script type="math/tex">r</script>. First, 
I substitue in <script type="math/tex">\rho</script> for <script type="math/tex">P</script>,</p>

<script type="math/tex; mode=display">\frac{\mathrm{d}\rho}{\mathrm{d}z} = -\frac{\rho g_{z}}{c_{s}^2}.</script>

<p>Then, I rearrange and integrate both sides:</p>

<script type="math/tex; mode=display">\frac{\mathrm{d}\rho}{\rho} = -\frac{g_{z}}{c_{s}^2}\mathrm{d}z ,</script>

<script type="math/tex; mode=display">\mathrm{ln}(\rho) + A = \frac{\Phi}{c_{s}^2} + C,</script>

<p>where I have substituted <script type="math/tex">\Phi</script> for the integral of <script type="math/tex">g_{z}\mathrm{d}z</script>. Exponentiating and 
rewriting the constant of integration, I get</p>

<script type="math/tex; mode=display">\rho = B e^{(\frac{\Phi}{c_{s}^2}+C)}.</script>

<p>To solve for the constants, we need boundary conditions. We can set <script type="math/tex">B</script> by saying that 
<script type="math/tex">\rho = \rho_{0}</script> when <script type="math/tex">z = 0</script>, where <script type="math/tex">\rho_{0}</script> is the central density at a given <script type="math/tex">r</script>. Then we have</p>

<script type="math/tex; mode=display">\rho = \rho_{0} e^{(\frac{\Phi}}{c_{s}^2} - \frac{\Phi_0}{c_{s}^2})},</script>

<p>where <script type="math/tex">\Phi_{0}</script> is just the value of <script type="math/tex">\Phi</script> evaluated at <script type="math/tex">z = 0</script>. To solve for <script type="math/tex">\rho_0</script>, we apply 
the constraint that the integral of the density profile over <script type="math/tex">z</script> must equal the surface density,</p>

<script type="math/tex; mode=display">\Sigma = \int_{0}^{\infty} \rho_{0} e^{(\frac{\Phi_{0}}{c_{s}^2} - \frac{\Phi}{c_{s}^2})} \mathrm{d}z.</script>

<p>Generally, this integral will need to be evaluated numerically.</p>

    </section>
</article>
<footer id="post-meta" class="clearfix">
    <a href="http://twitter.com/navelation">
        <img class="avatar" src="http://evaneschneider.github.io/site/assets/images/avatar.png">
        <div>
            <span class="dark">Evan Schneider</span>
            <span>Blogging about stuff</span>
        </div>
    </a>

    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=/2017/Milky-Way-3D/ - Milky Way 3D by @navelation"><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>
    </section>
</footer>

<!-- Disqus comments -->


<!-- Archive post list -->




  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="http://evaneschneider.github.io/site/assets/js/main.js"></script>
  <script src="http://evaneschneider.github.io/site/assets/js/highlight.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXXX-X', 'auto');
    ga('send', 'pageview');
  </script>
  <!-- Include mathjax support -->
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

</body>
</html>



